<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/fetchData.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/fetchData.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Octokit } from "octokit";
import { preProcessJSON } from "./preProcessJSON";

/**
 * @description instantiate new octokit to use REST API using access token from GitHub
 * @type Octokit
 */
//
const octokit = new Octokit({ 
    auth: import.meta.env.VITE_API_KEY,
  });

/**
 * @description makes api call using Octokit &amp; REST API to access a github repo folder.
 * 
 * @returns {Array} an array of file names to display in the dropdown menu and make the api call on selection
 */
//
export const fetchPathList = async () => {
    const response = await octokit.request("GET /repos/{owner}/{repo}/contents", {
        owner: import.meta.env.VITE_REPO_OWNER,
        repo: import.meta.env.VITE_REPO_NAME,
        per_page: 2
    });
    
    const dataPathList = []
    
    for (let index = 0; index &lt; response.data.length; index++) {
        dataPathList.push(response.data[index].path)
    }

    return(dataPathList);
}

/**
 * @description makes api call using Octokit &amp; REST API to access a github repo file to receive the data
 * 
 * @param {string} path file name of the selected data in the select box on top of the page
 * 
 * @returns {Array} the selected JSON file's Routes to display on the table
 */
//

export const fetchData = async (path) => {
    
      /**
       * on selection make the api call
       */
      const dataFile = await octokit.request(`GET /repos/{owner}/{repo}/contents/${path}`, {
        mode: 'no-cors',
        owner: import.meta.env.VITE_REPO_OWNER,
        repo: import.meta.env.VITE_REPO_NAME,
        per_page: 2
      });

      /**
       * atob function decodes base64 encoded data.
       */
      const JSONcontents = JSON.parse(atob(dataFile.data.content));
      const JSONroutes = preProcessJSON(JSONcontents);
      
      return(JSONroutes);
    
  };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#fetchData">fetchData</a></li><li><a href="global.html#fetchPathList">fetchPathList</a></li><li><a href="global.html#filter">filter</a></li><li><a href="global.html#getOrder">getOrder</a></li><li><a href="global.html#keys">keys</a></li><li><a href="global.html#octokit">octokit</a></li><li><a href="global.html#preProcessJSON">preProcessJSON</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#sorting">sorting</a></li><li><a href="global.html#useWindowSize">useWindowSize</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Wed Aug 09 2023 04:59:02 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
